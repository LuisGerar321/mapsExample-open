<!DOCTYPE html>
<html>
  <head>
    <base target="_top" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>
  </head>
  <body>
    <div id="map" style="height: 100vh; width: 100vw"></div>
    <script>
      let map;
      let marker;

      function geoFindMe() {
        if (navigator.geolocation) {
          navigator.geolocation.watchPosition(showPosition);
          function showPosition(position) {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;

            if (!map) {
              map = L.map("map").setView([latitude, longitude], 19);
              L.tileLayer(
                "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
                {
                  maxZoom: 20.5,
                  attribution:
                    '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                }
              ).addTo(map);
            }

            // Crear o actualizar el marcador
            if (!marker) {
              marker = L.marker([latitude, longitude]).addTo(map);
            } else {
              marker.setLatLng([latitude, longitude]);
            }
          }
        }
      }

      document.addEventListener("DOMContentLoaded", function () {
        geoFindMe();
      });
    </script>
  </body>
</html>
